---
- name: Reboot primary (module)
  ansible.builtin.reboot:
    reboot_timeout: "{{ reboot_timeout | default(600) }}"
    pre_reboot_delay: 0
    post_reboot_delay: "{{ post_reboot_delay | default(10) }}"
    test_command: whoami

- name: Wait for SSH on host to become available
  ansible.builtin.wait_for_connection:
    timeout: "{{ reboot_timeout | default(600) }}"

- name: Simple health check (hostname)
  ansible.builtin.command:
    cmd: hostname
  register: hostname_check
  changed_when: false

- name: Show health check result
  ansible.builtin.debug:
    msg: "Host {{ inventory_hostname }} responded with hostname: {{ hostname_check.stdout }}"
